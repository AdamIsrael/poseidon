<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Poseidon by changhiskhan</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Poseidon</h1>
        <p>Python CLI for Digital Ocean API v2</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/changhiskhan/poseidon" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Downloads:</span>
          <ul>
            <li><a href="https://github.com/changhiskhan/poseidon/zipball/master" class="button">ZIP</a></li>
            <li><a href="https://github.com/changhiskhan/poseidon/tarball/master" class="button">TAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul></ul>
      </nav>
      <section>
        <h1>
<a name="poseidon" class="anchor" href="#poseidon"><span class="octicon octicon-link"></span></a>poseidon</h1>

<p>Python library for managing your Digital Ocean account via API v2</p>

<p>The DigitalOcean API allows you to manage Droplets and resources within the
DigitalOcean cloud in a simple, programmatic way using conventional HTTP
requests. The endpoints are intuitive and powerful, allowing you to easily make
calls to retrieve information or to execute actions.</p>

<p>All of the functionality that you are familiar with in the DigitalOcean control
panel is also available through the API, allowing you to script the complex
actions that your situation requires.</p>

<p>This library starts with a python wrapper for the API and aims to build tools to
make it easier to manage, provision, and deploy to Digital Ocean.</p>

<h2>
<a name="setup" class="anchor" href="#setup"><span class="octicon octicon-link"></span></a>Setup</h2>

<p><code>pip install -U poseidon</code></p>

<p>To run the unit tests make sure you have the <code>pytest</code> module.
If not, run <code>pip install -U pytest</code></p>

<h2>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h2>

<p>Setup authentication by generating an API key and exporting it as the value of the
<code>DIGITALOCEAN_API_KEY</code> environment variable.</p>

<h3>
<a name="connect-to-api" class="anchor" href="#connect-to-api"><span class="octicon octicon-link"></span></a>Connect to API</h3>

<pre><code>import poseidon.api as po
client = po.connect() # or po.connect(api_key=&lt;KEY&gt;) for custom api key
</code></pre>

<h3>
<a name="create-a-droplet" class="anchor" href="#create-a-droplet"><span class="octicon octicon-link"></span></a>Create a droplet</h3>

<pre><code>image_id = 135123 # replace with your own
droplet = client.droplets.create(name='test', region='sfo1', size='512mb',
                                 image=image_id)
</code></pre>

<h3>
<a name="programmatically-create-a-snapshot" class="anchor" href="#programmatically-create-a-snapshot"><span class="octicon octicon-link"></span></a>Programmatically create a snapshot</h3>

<pre><code>droplet.power_off() # snapshots are only allowed while powered off
droplet.take_snapshot('test-snapshot')
</code></pre>

<h3>
<a name="check-that-it-worked" class="anchor" href="#check-that-it-worked"><span class="octicon octicon-link"></span></a>Check that it worked</h3>

<pre><code>snapshots = droplet.snapshots() # one of these should be named 'test-snapshot'
</code></pre>

<h3>
<a name="other-simple-droplet-commands" class="anchor" href="#other-simple-droplet-commands"><span class="octicon octicon-link"></span></a>Other simple droplet commands</h3>

<pre><code>droplet.reboot()
droplet.shutdown()
droplet.power_on()
droplet.power_cycle()
droplet.password_reset()
droplet.enable_ipv6()
droplet.disable_backups()
droplet.enable_private_networking()
</code></pre>

<h3>
<a name="droplet-commands-that-take-a-parameter" class="anchor" href="#droplet-commands-that-take-a-parameter"><span class="octicon octicon-link"></span></a>Droplet commands that take a parameter</h3>

<pre><code>droplet.resize('1024mb')
droplet.restore(image_id) # integer
droplet.rebuild(image_id)
droplet.rename('new-name')
droplet.change_kernel(12534)
</code></pre>

<h3>
<a name="delete-droplet" class="anchor" href="#delete-droplet"><span class="octicon octicon-link"></span></a>Delete droplet</h3>

<p><code>droplet.delete()</code></p>

<h3>
<a name="keys" class="anchor" href="#keys"><span class="octicon octicon-link"></span></a>Keys</h3>

<pre><code># list keys
client.keys.list() # it works

# create a new key
public_key = ("ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAAAQQDWF7SdoK0JvdjGR/8MHjj"
              "b7qtKVSdqoVZ2bCX0SXdn2pxZitnFjUx+lQ4osMGjOOTE/Hi86qQnFGE8Ym"
              "Sur/LT example")
key = client.keys.create('test-key', public_key)
print rs['public_key']
print rs['name']

# rename the key
client.keys.update(key['id'], 'test-key2')

# delete the key
client.keys.delete(new_id)
</code></pre>

<h3>
<a name="domains" class="anchor" href="#domains"><span class="octicon octicon-link"></span></a>Domains</h3>

<pre><code># list domains
client.domains.list() # it works

# create new domain
ip_address = '127.0.0.1'
test = 'b7qtKVSdqoVZ2bCX0SXdn2pxZitnFjUx.com' # must be unique
domain = client.domains.create(test, ip_address)
print domain['name']

# retrieve a domain by name
new_domain = client.domains.get(domain['name'])

# delete a domain by name
client.domains.delete(new_domain['name'])
</code></pre>

<h3>
<a name="regions" class="anchor" href="#regions"><span class="octicon octicon-link"></span></a>Regions</h3>

<p><code>client.regions.list()</code></p>

<h3>
<a name="sizes" class="anchor" href="#sizes"><span class="octicon octicon-link"></span></a>Sizes</h3>

<p><code>client.sizes.list()</code></p>

<h2>
<a name="testing" class="anchor" href="#testing"><span class="octicon octicon-link"></span></a>Testing</h2>

<pre><code>pip install -U pytest
py.test
</code></pre>

<p>Because the test for droplets goes through the exercise of creating a new droplet,
modifying it, then finally destroying it, the test takes a long time to run.
To only run the other tests, use the <code>not slow</code> marker from <code>pytest</code>:</p>

<pre><code>~$ py.test -v -m "not slow"
===================================== test session starts ======================================
platform linux2 -- Python 2.7.6 -- py-1.4.23 -- pytest-2.6.0 --
collected 8 items

tests/test_api.py@72::test_regions PASSED
tests/test_api.py@82::test_sizes PASSED
tests/test_api.py@92::test_actions PASSED
tests/test_api.py@101::test_keys PASSED
tests/test_api.py@122::test_domains PASSED
tests/test_api.py@141::test_domain_records PASSED
tests/test_api.py@145::test_images PASSED

============================ 1 tests deselected by "-m 'not slow'" =============================
============================ 7 passed, 1 deselected in 6.85 seconds ============================
</code></pre>

<h2>
<a name="todo" class="anchor" href="#todo"><span class="octicon octicon-link"></span></a>TODO</h2>

<ol>
<li>Refactor the result format to allow for easy multipage resultset paging</li>
<li>Additional unit tests</li>
<li>Tools for scaling, provisioning, deployment</li>
</ol>
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/changhiskhan">changhiskhan</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://twitter.com/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>